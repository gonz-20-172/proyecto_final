[03-Nov-2025 03:22:11 Europe/Berlin] === DEBUG getVisitData ===
[03-Nov-2025 03:22:11 Europe/Berlin] Visit ID recibido: '4'
[03-Nov-2025 03:22:11 Europe/Berlin] Tipo de Visit ID: string
[03-Nov-2025 03:22:11 Europe/Berlin] SQL Query: 
        SELECT 
            v.*,
            c.name as client_name,
            c.email as client_email,
            c.phone as client_phone,
            c.address as client_address,
            c.contact_person as client_contact,
            t.name as technician_name,
            t.email as technician_email,
            s.name as supervisor_name,
            s.email as supervisor_email
        FROM visits v
        INNER JOIN clients c ON v.client_id = c.id
        INNER JOIN users t ON v.technician_id = t.id
        INNER JOIN users s ON v.supervisor_id = s.id
        WHERE v.id = ?
    
[03-Nov-2025 03:22:11 Europe/Berlin] Parámetro: 4
[03-Nov-2025 03:22:11 Europe/Berlin] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[03-Nov-2025 03:22:11 Europe/Berlin] No se encontró visita con ID: 4
[03-Nov-2025 03:22:11 Europe/Berlin] La visita existe pero no pasó el JOIN. Estado: completed
[03-Nov-2025 03:26:54 Europe/Berlin] === DEBUG getVisitData ===
[03-Nov-2025 03:26:54 Europe/Berlin] Visit ID recibido: '3'
[03-Nov-2025 03:26:54 Europe/Berlin] Tipo de Visit ID: string
[03-Nov-2025 03:26:54 Europe/Berlin] SQL Query: 
        SELECT 
            v.*,
            c.name as client_name,
            c.email as client_email,
            c.phone as client_phone,
            c.address as client_address,
            c.contact_person as client_contact,
            t.name as technician_name,
            t.email as technician_email,
            s.name as supervisor_name,
            s.email as supervisor_email
        FROM visits v
        INNER JOIN clients c ON v.client_id = c.id
        INNER JOIN users t ON v.technician_id = t.id
        INNER JOIN users s ON v.supervisor_id = s.id
        WHERE v.id = ?
    
[03-Nov-2025 03:26:54 Europe/Berlin] Parámetro: 3
[03-Nov-2025 03:26:54 Europe/Berlin] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[03-Nov-2025 03:26:54 Europe/Berlin] No se encontró visita con ID: 3
[03-Nov-2025 03:26:54 Europe/Berlin] La visita existe pero no pasó el JOIN. Estado: completed
[03-Nov-2025 03:43:14 Europe/Berlin] ===== REPORTS.PHP DEBUG =====
[03-Nov-2025 03:43:14 Europe/Berlin] REQUEST_METHOD: POST
[03-Nov-2025 03:43:14 Europe/Berlin] GET params: {"action":"resend","visit_id":"4"}
[03-Nov-2025 03:43:14 Europe/Berlin] REQUEST_URI: /api/reports.php?action=resend&visit_id=4
[03-Nov-2025 03:43:14 Europe/Berlin] QUERY_STRING: action=resend&visit_id=4
[03-Nov-2025 03:43:14 Europe/Berlin] Action: resend
[03-Nov-2025 03:43:14 Europe/Berlin] Visit ID: '4'
[03-Nov-2025 03:43:14 Europe/Berlin] Visit ID type: string
[03-Nov-2025 03:43:14 Europe/Berlin] === RESEND REPORT ===
[03-Nov-2025 03:43:14 Europe/Berlin] Visit ID recibido en resendReport: '4'
[03-Nov-2025 03:43:14 Europe/Berlin] Llamando a getVisitData con ID: 4
[03-Nov-2025 03:43:14 Europe/Berlin] === GET VISIT DATA ===
[03-Nov-2025 03:43:14 Europe/Berlin] Visit ID recibido: '4'
[03-Nov-2025 03:43:14 Europe/Berlin] Visit ID type: string
[03-Nov-2025 03:43:14 Europe/Berlin] Ejecutando query con parámetro: [4]
[03-Nov-2025 03:43:14 Europe/Berlin] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[03-Nov-2025 03:43:14 Europe/Berlin] Query no retornó resultados
[03-Nov-2025 03:43:14 Europe/Berlin] Check simple (sin JOINs): {"id":4,"client_id":4,"supervisor_id":2,"technician_id":3,"scheduled_date":"2025-11-02","scheduled_time":"17:00:00","status":"completed","notes":"express","created_at":"2025-11-02 16:37:12","updated_at":"2025-11-02 16:38:22"}
[03-Nov-2025 03:43:14 Europe/Berlin] ERROR: getVisitData retornó null para ID: 4
[03-Nov-2025 03:43:14 Europe/Berlin] Check directo en BD: {"id":4,"status":"completed","client_id":4,"technician_id":3,"supervisor_id":2}
[03-Nov-2025 03:44:13 Europe/Berlin] ===== REPORTS.PHP DEBUG =====
[03-Nov-2025 03:44:13 Europe/Berlin] REQUEST_METHOD: POST
[03-Nov-2025 03:44:13 Europe/Berlin] GET params: {"action":"resend","visit_id":"4"}
[03-Nov-2025 03:44:13 Europe/Berlin] REQUEST_URI: /api/reports.php?action=resend&visit_id=4
[03-Nov-2025 03:44:13 Europe/Berlin] QUERY_STRING: action=resend&visit_id=4
[03-Nov-2025 03:44:13 Europe/Berlin] Action: resend
[03-Nov-2025 03:44:13 Europe/Berlin] Visit ID: '4'
[03-Nov-2025 03:44:13 Europe/Berlin] Visit ID type: string
[03-Nov-2025 03:44:13 Europe/Berlin] === RESEND REPORT ===
[03-Nov-2025 03:44:13 Europe/Berlin] Visit ID recibido en resendReport: '4'
[03-Nov-2025 03:44:13 Europe/Berlin] Llamando a getVisitData con ID: 4
[03-Nov-2025 03:44:13 Europe/Berlin] === GET VISIT DATA ===
[03-Nov-2025 03:44:13 Europe/Berlin] Visit ID recibido: '4'
[03-Nov-2025 03:44:13 Europe/Berlin] Visit ID type: string
[03-Nov-2025 03:44:13 Europe/Berlin] Ejecutando query con parámetro: [4]
[03-Nov-2025 03:44:13 Europe/Berlin] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[03-Nov-2025 03:44:13 Europe/Berlin] Query no retornó resultados
[03-Nov-2025 03:44:13 Europe/Berlin] Check simple (sin JOINs): {"id":4,"client_id":4,"supervisor_id":2,"technician_id":3,"scheduled_date":"2025-11-02","scheduled_time":"17:00:00","status":"completed","notes":"express","created_at":"2025-11-02 16:37:12","updated_at":"2025-11-02 16:38:22"}
[03-Nov-2025 03:44:13 Europe/Berlin] ERROR: getVisitData retornó null para ID: 4
[03-Nov-2025 03:44:13 Europe/Berlin] Check directo en BD: {"id":4,"status":"completed","client_id":4,"technician_id":3,"supervisor_id":2}
[03-Nov-2025 04:17:50 Europe/Berlin] ===== REPORTS.PHP DEBUG =====
[03-Nov-2025 04:17:50 Europe/Berlin] REQUEST_METHOD: POST
[03-Nov-2025 04:17:50 Europe/Berlin] GET params: {"action":"resend","visit_id":"4"}
[03-Nov-2025 04:17:50 Europe/Berlin] REQUEST_URI: /api/reports.php?action=resend&visit_id=4
[03-Nov-2025 04:17:50 Europe/Berlin] QUERY_STRING: action=resend&visit_id=4
[03-Nov-2025 04:17:50 Europe/Berlin] Action: resend
[03-Nov-2025 04:17:50 Europe/Berlin] Visit ID: '4'
[03-Nov-2025 04:17:50 Europe/Berlin] Visit ID type: string
[03-Nov-2025 04:17:50 Europe/Berlin] === RESEND REPORT ===
[03-Nov-2025 04:17:50 Europe/Berlin] Visit ID recibido en resendReport: '4'
[03-Nov-2025 04:17:50 Europe/Berlin] Llamando a getVisitData con ID: 4
[03-Nov-2025 04:17:50 Europe/Berlin] === GET VISIT DATA ===
[03-Nov-2025 04:17:50 Europe/Berlin] Visit ID recibido: '4'
[03-Nov-2025 04:17:50 Europe/Berlin] Visit ID type: string
[03-Nov-2025 04:17:50 Europe/Berlin] Ejecutando query con parámetro: [4]
[03-Nov-2025 04:17:50 Europe/Berlin] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[03-Nov-2025 04:17:50 Europe/Berlin] Query no retornó resultados
[03-Nov-2025 04:17:50 Europe/Berlin] Check simple (sin JOINs): {"id":4,"client_id":4,"supervisor_id":2,"technician_id":3,"scheduled_date":"2025-11-02","scheduled_time":"17:00:00","status":"completed","notes":"express","created_at":"2025-11-02 16:37:12","updated_at":"2025-11-02 16:38:22"}
[03-Nov-2025 04:17:50 Europe/Berlin] ERROR: getVisitData retornó null para ID: 4
[03-Nov-2025 04:17:50 Europe/Berlin] Check directo en BD: {"id":4,"status":"completed","client_id":4,"technician_id":3,"supervisor_id":2}
[04-Nov-2025 23:03:28 America/Guatemala] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[04-Nov-2025 23:04:45 America/Guatemala] PHP Fatal error:  Cannot redeclare generateVisitPDF() (previously declared in C:\Users\Douglas GT\Documents\proyecto\api\reports.php:15) in C:\Users\Douglas GT\Documents\proyecto\includes\pdf_generator.php on line 15
[04-Nov-2025 23:07:14 America/Guatemala] PHP Fatal error:  Cannot redeclare generateVisitPDF() (previously declared in C:\Users\Douglas GT\Documents\proyecto\api\reports.php:15) in C:\Users\Douglas GT\Documents\proyecto\includes\pdf_generator.php on line 15
[04-Nov-2025 23:08:40 America/Guatemala] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[04-Nov-2025 23:13:54 America/Guatemala] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT COUNT(*) as total FROM visits
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: []
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT * FROM visits WHERE id = ?
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM clients WHERE id = ?
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM users WHERE id = ?
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [3]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM users WHERE id = ?
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [2]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: SELECT * FROM visits WHERE id = ?
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] QueryOne ejecutada: 
    SELECT v.*, c.name as client_name
    FROM visits v
    LEFT JOIN clients c ON v.client_id = c.id
    WHERE v.id = ?

[04-Nov-2025 23:25:55 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:25:55 America/Guatemala] [DB] Error en dbQueryOne: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[04-Nov-2025 23:25:55 America/Guatemala] [DB] SQL: 
    SELECT 
        v.*,
        c.name as client_name,
        c.email as client_email,
        c.phone as client_phone,
        c.address as client_address,
        c.contact_person as client_contact,
        t.name as technician_name,
        t.email as technician_email,
        s.name as supervisor_name,
        s.email as supervisor_email
    FROM visits v
    LEFT JOIN clients c ON v.client_id = c.id
    LEFT JOIN users t ON v.technician_id = t.id
    LEFT JOIN users s ON v.supervisor_id = s.id
    WHERE v.id = ?

[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT COUNT(*) as total FROM visits
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: []
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT * FROM visits WHERE id = ?
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM clients WHERE id = ?
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM users WHERE id = ?
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [3]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT id, name FROM users WHERE id = ?
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [2]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: SELECT * FROM visits WHERE id = ?
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] QueryOne ejecutada: 
    SELECT v.*, c.name as client_name
    FROM visits v
    LEFT JOIN clients c ON v.client_id = c.id
    WHERE v.id = ?

[04-Nov-2025 23:31:39 America/Guatemala] [DB] Parámetros: [4]
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Resultado: 1 fila
[04-Nov-2025 23:31:39 America/Guatemala] [DB] Error en dbQueryOne: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[04-Nov-2025 23:31:39 America/Guatemala] [DB] SQL: 
    SELECT 
        v.*,
        c.name as client_name,
        c.email as client_email,
        c.phone as client_phone,
        c.address as client_address,
        c.contact_person as client_contact,
        t.name as technician_name,
        t.email as technician_email,
        s.name as supervisor_name,
        s.email as supervisor_email
    FROM visits v
    LEFT JOIN clients c ON v.client_id = c.id
    LEFT JOIN users t ON v.technician_id = t.id
    LEFT JOIN users s ON v.supervisor_id = s.id
    WHERE v.id = ?

[04-Nov-2025 23:31:39 America/Guatemala] PHP Fatal error:  Uncaught PDOException: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list' in C:\Users\Douglas GT\Documents\proyecto\test_pdf.php:118
Stack trace:
#0 C:\Users\Douglas GT\Documents\proyecto\test_pdf.php(118): PDO->prepare('\r\n    SELECT \r\n...')
#1 {main}
  thrown in C:\Users\Douglas GT\Documents\proyecto\test_pdf.php on line 118
[04-Nov-2025 23:36:55 America/Guatemala] Error en consulta: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'c.contact_person' in 'field list'
[05-Nov-2025 22:16:56 America/Guatemala] PHP Warning:  require_once(C:\Users\Douglas GT\Documents\proyecto/includes/pdf_generator.php): Failed to open stream: No such file or directory in C:\Users\Douglas GT\Documents\proyecto\test_pdf.php on line 7
[05-Nov-2025 22:16:56 America/Guatemala] PHP Fatal error:  Uncaught Error: Failed opening required 'C:\Users\Douglas GT\Documents\proyecto/includes/pdf_generator.php' (include_path='C:\xampp\php\PEAR') in C:\Users\Douglas GT\Documents\proyecto\test_pdf.php:7
Stack trace:
#0 {main}
  thrown in C:\Users\Douglas GT\Documents\proyecto\test_pdf.php on line 7
